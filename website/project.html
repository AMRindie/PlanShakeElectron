﻿<!DOCTYPE html>
<html lang="en" data-page="project">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project View</title>
  <link rel="icon" href="PlanShake512x512.png" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="PlanShake">
  <link rel="apple-touch-icon" href="PlanShake192x192.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>

<body>
  <header class="app-header">
    <div class="header-left">
      <button class="back-btn" onclick="window.location.href='index.html'">
        <span class="icon">←</span> All Projects
      </button>
      <div class="divider-vertical"></div>
      <div class="project-title-wrapper">
        <div class="project-icon-wrapper">
          <span id="projectIconDisplay" class="project-icon-display">📋</span>
          <div id="projectIconDropdown" class="project-icon-dropdown hidden">
            <!-- Icons injected via JS -->
          </div>
        </div>
        <input id="projectTitleInput" class="project-title-input" placeholder="Project name..." />
      </div>
    </div>

    <div class="header-right">
      <div class="project-meta-bar">
        <div class="cover-picker-wrapper">
          <div class="cover-picker">
            <label class="cover-mode-toggle" for="projectCoverColorToggle">
              <input type="checkbox" id="projectCoverColorToggle" checked />
              <span class="toggle-slider"></span>
            </label>
            <div class="cover-swatch cover-blue" data-cover="blue"></div>
            <div class="cover-swatch cover-purple" data-cover="purple"></div>
            <div class="cover-swatch cover-green" data-cover="green"></div>
            <div class="cover-swatch cover-orange" data-cover="orange"></div>
            <div class="cover-swatch cover-dark" data-cover="dark"></div>
          </div>
        </div>
      </div>

      <button id="toggleMenuBtn" class="secondary-btn menu-toggle-btn" type="button">
        Menu
      </button>
    </div>
  </header>

  <div class="layout-container">
    <main class="board-main">

      <!-- Kanban Board Section -->
      <section id="board" class="board" data-project-view="board">
        <div class="list add-list">
          <button id="addListBtn" class="primary-btn full-width">+ Add another list</button>
          <div class="add-list-input-wrapper hidden">
            <input type="text" id="newListTitle" placeholder="List title..." />
          </div>
        </div>
      </section>

      <!-- Planner Section -->
      <section id="plannerView" class="planner-panel hidden" data-project-view="plannerView">
        <header class="panel-header">
          <div class="panel-title">
            <h2>Project Milestones</h2>
            <p>Define key phases and long-term goals.</p>
          </div>
        </header>
        <div class="planner-grid">
          <div class="planner-entry-list" id="plannerEntryList"></div>
          <form id="plannerEntryForm" class="planner-form">
            <h3>New Milestone</h3>
            <input id="plannerEntryTitle" type="text" placeholder="Milestone Title (e.g. Phase 1)" required />
            <textarea id="plannerEntryNotes" rows="2" placeholder="Details (optional)"></textarea>
            <div class="planner-form__row">
              <div class="date-group">
                <label>Start</label>
                <input id="plannerEntryStart" type="date" />
              </div>
              <div class="date-group">
                <label>End</label>
                <input id="plannerEntryDue" type="date" />
              </div>
              <select id="plannerEntryPriority">
                <option value="Low">Low Priority</option>
                <option value="Medium" selected>Medium Priority</option>
                <option value="High">High Priority</option>
              </select>
            </div>
            <button type="submit" class="primary-btn full-width">Add Milestone</button>
            <button id="plannerClearLowBtn" type="button" class="text-btn full-width">
              Clear Low Priority
            </button>
          </form>
        </div>
      </section>

      <!-- Calendar Section -->
      <section id="calendarView" class="calendar-panel hidden" data-project-view="calendarView">
        <header class="panel-header">
          <div class="panel-title">
            <h2>Timeline</h2>
            <p>Project roadmap and deadlines.</p>
          </div>
        </header>
        <div id="calendarContainer" class="calendar-container"></div>
      </section>

      <!-- Notes Section (Rich Text Editor) -->
      <section id="notesView" class="notes-panel hidden" data-project-view="notesView">
        <header class="panel-header">
          <div class="panel-title">
            <h2>Project Notes</h2>
            <p>Rich text documentation and thoughts.</p>
          </div>
          <span class="status-badge">Autosaved</span>
        </header>
        <div id="notesContainer" class="notes-container">
          <!-- Rich text editor will be injected here by app.notes.js -->
        </div>
      </section>

      <!-- Whiteboard Section -->
      <section id="whiteboardView" class="whiteboard-panel hidden" data-project-view="whiteboardView">

        <!-- Glass Toolbar with SVG Icons -->
        <div class="wb-toolbar">
          <div class="wb-tool-group">
            <button id="wbToolCursor" class="wb-btn active" title="Select / Move (V)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 13l6 6" />
              </svg>
            </button>
            <button id="wbToolHand" class="wb-btn" title="Pan Tool (Spacebar)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M10.05 4.575a1.575 1.575 0 10-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 013.15 0v1.5m-3.15 0l.075 5.925m3.075.75V4.575a1.575 1.575 0 013.15 0v3.15m-3.15 0v1.5c0 .156.125.281.281.281h2.25c.938 0 1.5.563 1.5 1.5v3.375c0 2.484-2.016 4.5-4.5 4.5h-3.375c-2.484 0-4.5-2.016-4.5-4.5v-3.375c0-.938.563-1.5 1.5-1.5h.281c.156 0 .281-.125.281-.281V4.575a1.575 1.575 0 013.15 0v3" />
              </svg>
            </button>
            <button id="wbToolPen" class="wb-btn" title="Pen (B)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
              </svg>
            </button>
            <button id="wbToolEraser" class="wb-btn" title="Eraser (E)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M12 9.75L14.25 12m0 0l2.25 2.25M14.25 12l2.25-2.25M14.25 12L12 14.25m-2.58 4.92l-6.375-6.375a1.125 1.125 0 010-1.59L9.42 4.83c.211-.211.498-.33.796-.33H19.5a2.25 2.25 0 012.25 2.25v10.5a2.25 2.25 0 01-2.25 2.25h-9.284c-.298 0-.585-.119-.796-.33z" />
              </svg>
            </button>
          </div>

          <div class="divider-vertical"></div>

          <div class="wb-tool-group" id="wbStyleControls">
            <input type="color" id="wbPenColor" value="#000000" title="Pen Color">
            <div class="wb-range-wrapper" title="Size">
              <input type="range" id="wbPenSize" min="2" max="50" value="5">
            </div>
            <div class="wb-range-wrapper" title="Opacity">
              <input type="range" id="wbPenOpacity" min="10" max="100" value="100">
            </div>
          </div>

          <div class="divider-vertical"></div>

          <div class="wb-tool-group">
            <button id="wbAddNoteBtn" class="wb-btn" title="Add Sticky Note">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
              </svg>
            </button>
            <label class="wb-btn" title="Add Image" style="cursor:pointer">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
              </svg>
              <input type="file" id="wbAddImageInput" accept="image/*" hidden>
            </label>
            <button id="wbLayerBtn" class="wb-btn" title="Layers">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M6.429 9.75L2.25 12l4.179 2.25m0-4.5l5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0l4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0l-5.571 3-5.571-3" />
              </svg>
            </button>
            <button id="wbClearBtn" class="wb-btn danger-text" title="Clear Active Layer">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
              </svg>
            </button>
          </div>
        </div>

        <!-- Layer Panel (Floating) -->
        <div id="wbLayerPanel" class="wb-layer-panel hidden">
          <div class="layer-header">
            <span>Layers</span>
            <button id="wbAddLayerBtn" class="text-btn small">+ Add</button>
          </div>
          <div id="wbLayerList" class="layer-list">
            <!-- Layers injected via JS -->
          </div>
        </div>

        <!-- View Controls -->
        <div class="wb-view-controls">
          <button id="wbResetViewBtn" class="text-btn small">Reset View</button>
          <span id="wbZoomLevel">100%</span>
        </div>

        <!-- Main Container -->
        <div id="wbContainer" class="wb-container">
          <!-- 1. Grid Layer -->
          <div id="wbGridLayer" class="wb-grid-layer"></div>

          <!-- 2. Object Layer (DOM) -->
          <div id="wbObjectLayer"></div>

          <!-- 3. Canvas Layer (Ink) -->
          <canvas id="wbDrawingCanvas"></canvas>

          <!-- 4. Custom Cursor -->
          <div id="wbCursor" class="wb-cursor"></div>
        </div>
      </section>

    </main>

    <!-- Side Menu (Existing) -->
    <aside id="boardMenu" class="board-menu">
      <div class="menu-header">
        <h3>Details</h3>
        <button id="closeMenuBtnMobile" class="icon-btn mobile-only">✕</button>
      </div>

      <div class="menu-content">
        <div class="menu-section info-section">
          <div class="menu-project-header">
            <span id="menuProjectIcon" class="menu-project-icon">📋</span>
            <div class="menu-project-info">
              <h2 id="menuInfoTitle">Project Name</h2>
              <div class="menu-info-tags" id="menuInfoTags"></div>
            </div>
          </div>

          <div class="meta-stats">
            <div class="stat">
              <strong id="menuListCount">0</strong>
              <span>Lists</span>
            </div>
            <div class="stat">
              <strong id="menuCardCount">0</strong>
              <span>Cards</span>
            </div>
            <div class="stat">
              <strong id="menuStatus">Active</strong>
              <span>Status</span>
            </div>
            <div class="stat">
              <strong id="menuCreated">Today</strong>
              <span>Created</span>
            </div>
          </div>
        </div>

        <div class="menu-section">
          <label>Description</label>
          <textarea id="projectDescriptionInput" rows="4" placeholder="Add project context..."></textarea>
        </div>

        <div class="menu-section">
          <label>Quick Actions</label>
          <div class="menu-btn-stack">
            <button id="archiveDoneCardsBtn" class="secondary-btn">
              <span class="btn-icon">📦</span>
              Archive Completed Cards
            </button>
            <button id="showArchiveBtn" class="secondary-btn">
              <span class="btn-icon">📂</span>
              View Archive
            </button>
          </div>
        </div>

        <div id="archivePanel" class="archive-panel hidden">
          <h4>Archive</h4>
          <div id="archivedCardsContainer"></div>
          <!-- Close button removed, controlled by toggle -->
        </div>

        <div class="menu-section">
          <label>Danger Zone</label>
          <div class="menu-btn-stack">
            <button id="deleteAllCardsBtn" class="secondary-btn danger-action">
              <span class="btn-icon">🗑️</span>
              Delete All Cards
            </button>
            <button id="deleteAllListsBtn" class="secondary-btn danger-action">
              <span class="btn-icon">🗑️</span>
              Delete All Lists
            </button>
          </div>
        </div>

        <small class="last-saved" id="menuLastSaved">Syncing...</small>
      </div>
    </aside>
    <div id="boardMenuOverlay" class="board-menu-overlay hidden"></div>
  </div>

  <div id="cardModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content" style="max-width: 640px;">

      <div id="modalCoverBanner" class="modal-cover-banner hidden"></div>

      <div class="modal-header">
        <h3>Edit Card</h3>
        <button id="closeModalBtn" class="icon-btn">✕</button>
      </div>

      <div class="modal-body">
        <div class="modal-section no-margin-bottom">
          <label>Title</label>
          <input id="cardTitleInput" class="full-width" placeholder="Card title..." />
        </div>

        <div class="modal-section" style="margin-top: 20px;">
          <label>Cover</label>
          <div class="card-cover-controls-compact">
            <div class="card-cover-mode-row">
              <button type="button" id="cardCoverColorModeBtn" class="secondary-btn small">Color</button>
              <button type="button" id="cardCoverImageModeBtn" class="secondary-btn small">Image</button>
              <button type="button" id="cardCoverClearBtn" class="text-btn small" style="margin-left: auto;">Remove
                Cover</button>
            </div>

            <div class="card-cover-color-row">
              <span class="card-cover-color" data-color="#ef4444" style="background:#ef4444"></span>
              <span class="card-cover-color" data-color="#f97316" style="background:#f97316"></span>
              <span class="card-cover-color" data-color="#eab308" style="background:#eab308"></span>
              <span class="card-cover-color" data-color="#22c55e" style="background:#22c55e"></span>
              <span class="card-cover-color" data-color="#06b6d4" style="background:#06b6d4"></span>
              <span class="card-cover-color" data-color="#3b82f6" style="background:#3b82f6"></span>
              <span class="card-cover-color" data-color="#a855f7" style="background:#a855f7"></span>
              <span class="card-cover-color" data-color="#334155" style="background:#334155"></span>
            </div>

            <input id="cardCoverImageInput" type="file" accept="image/*" class="hidden" />

            <div id="coverTextOptions" class="hidden" style="margin-top:8px; display:flex; gap:8px;">
              <input id="cardCoverTextInput" type="text" class="full-width" placeholder="Overlay text..." />
              <select id="cardCoverPositionSelect" style="width: 120px;">
                <option value="center">Middle</option>
                <option value="top">Top</option>
                <option value="bottom">Bottom</option>
                <option value="left">Left</option>
                <option value="right">Right</option>
                <option value="top-left">Top Left</option>
                <option value="top-right">Top Right</option>
                <option value="bottom-left">Bottom Left</option>
                <option value="bottom-right">Bottom Right</option>
              </select>
            </div>
          </div>
        </div>

        <div class="modal-section">
          <label>Description</label>
          <textarea id="cardDescriptionInput" rows="3" class="full-width"
            placeholder="Add a more detailed description..."></textarea>
        </div>

        <div class="modal-grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
          <div>
            <div class="modal-section">
              <label>Start Date</label>
              <input id="cardDueDateInput" type="date" class="full-width" />
            </div>
            <div class="modal-section">
              <label>Duration (Days)</label>
              <input id="cardDurationInput" type="number" min="1" value="1" class="full-width" />
            </div>
          </div>

          <div class="modal-section">
            <label>Labels</label>
            <div class="label-picker-compact">
              <div class="label-input-row">
                <input id="cardLabelsInput" type="text" class="full-width" placeholder="Search or create..." />
                <button id="addLabelBtn" class="secondary-btn small">+</button>
              </div>
              <div class="label-color-row">
                <span class="label-color" data-color="#ef4444" style="background:#ef4444"></span>
                <span class="label-color" data-color="#f97316" style="background:#f97316"></span>
                <span class="label-color" data-color="#22c55e" style="background:#22c55e"></span>
                <span class="label-color" data-color="#3b82f6" style="background:#3b82f6"></span>
              </div>
              <div id="labelListContainer" class="label-list"></div>
            </div>
          </div>
        </div>

        <div class="modal-section">
          <label>Checklist</label>
          <div class="checklist-input-group">
            <input type="text" id="newChecklistItemInput" class="full-width" placeholder="Add an item..." />
            <button id="addChecklistItemBtn" class="secondary-btn">Add</button>
          </div>
          <ul id="checklistContainer" class="checklist"></ul>
        </div>
      </div>

      <div class="modal-footer" style="justify-content: space-between;">
        <button id="permanentDeleteCardBtn" class="danger-btn">Delete</button>
        <div style="display: flex; gap: 8px;">
          <button id="archiveCardBtn" class="secondary-btn">Archive</button>
          <button id="saveCardBtn" class="primary-btn">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <nav class="bottom-nav" aria-label="Project navigation">
    <div class="glass-noise">
      <button type="button" class="bottom-nav__link bottom-nav__link--active" data-view-target="board">
        Board
      </button>
      <button type="button" class="bottom-nav__link" data-view-target="plannerView">
        Milestones
      </button>
      <button type="button" class="bottom-nav__link" data-view-target="calendarView">
        Timeline
      </button>
      <button type="button" class="bottom-nav__link" data-view-target="notesView">
        Notes
      </button>
      <button type="button" class="bottom-nav__link" data-view-target="whiteboardView">
        Whiteboard
      </button>
    </div>
  </nav>

  <script src="app.data.js"></script>
  <script src="app.notes.js"></script>
  <script src="app.js"></script>
  <script src="app.whiteboard.js" type="module"></script>
  <script src="app.planner.js"></script>
  <script src="app.calendar.js"></script>
</body>

</html>